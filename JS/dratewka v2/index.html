<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="author" content="damian filipowski" />
    <title>Dratewka</title>
    <style>
        @font-face
        {
            font-family: PressStart2P;
            src: url(fonts/PressStart2P.ttf);
        }
        body {
            background-color: black;
            color: darkgrey;
            font-family: PressStart2P;
        }
        #gameDiv {
            position: relative;
            margin:50px auto;
            width: 600px;
            height: 330px;
            background-color: black;
            display: block;
            font-size: 15px;
            background-size: 100% 100%;
        }
        #label {
            position:absolute;
            left: 10px;
            bottom: 10px;

        }
        #input {
            height:30px;
            width: 300px;
            padding-bottom: 0;
            margin-left: 10px;
            background-color: black;
            color: darkgrey;
            font-family: PressStart2P;
            font-size: 15px;
            border: 1px black solid;
            outline: none;
            color: transparent;
            text-shadow: 0 0 0 darkgray;
        }
        .text {
            position:relative;
            margin: 10px;
        }
        #seeText {
            width:1000px;
        }
        #picture, #picture2 {
            display:block;
            position: relative;
            width:258px;
            height: 160px;
            border: 2px darkgray solid;
            margin: 10px;
            background-size: 260px 160px;
            background-repeat: no-repeat;
            overflow:hidden;
        }

        #picture2 {
            margin:0;
            border: 0px;
            background-position: left top;
        }

        #kompas {
          display:block;
          position:absolute;
          right: 30px;
          bottom: 140px;
          width: 256px;
          height: 120px;
          background-color: black;
          background-image: url("gfx/kompas.bmp");
          background-size: 256px 120px;
          background-repeat: no-repeat;
        }

        .kw {
          width:15px;
          height:15px;
          position:absolute;
          background-color: black;
          display: none;
        }

        #kw0 {
          left:115px;
          top:-2px;
        }
        #kw1 {
          left:228px;
          top:34px;
        }
        #kw2 {
          left:118px;
          bottom:0;
        }
        #kw3 {
          left:15px;
          top:34px;
        }

        #komunikat {
          position:absolute;
          bottom:5px;
          left:9px;
          height:30px;
          width:580px;
          background-color: black;
          display:none;
        }

        #d_kom1 {
          position:absolute;
          bottom:10px;
          left:9px;
          background-color: black;
          width:580px;
          height:122px;
          z-index: 100;
          display:none;
          line-height: 17px;
        }
    </style>
    <script>
        //game.location[game.x][game.y].item = [["11", "an AXE", "1", "AXE"],["13", "sheeplegs", "0", "sheeplegs"],["17", "sheeptrunk", "0", "sheeptrunk"],["20", "a sheepskin" ,"0" ,"sheepskin"],["23", "a sheephead" ,"0" ,"sheephead"],["26", "a solid poison" ,"0" ,"solid poison"],["29", "a liquid poison" ,"0" ,"liquid poison"]]
        window.onload = function () {
            var div = document.createElement("DIV");
            div.setAttribute("id","gameDiv");
            div.style.backgroundImage= "url('gfx/czolowka1.jpg')"
            document.body.append(div);

            var audio = document.createElement("audio");
            audio.setAttribute("id","audio");
            document.body.append(audio);

            var audio_src = document.createElement("source");
            audio_src.setAttribute("id","audio_src");
            audio_src.setAttribute("src", "sounds/hejnal.mp3")
            audio_src.setAttribute("type", "audio/mpeg")
            document.getElementById("audio").append(audio_src);

            document.getElementById("audio").play(); //-------------------------------MUZYKA

            var licz_klik= 0;
            document.body.onkeyup= function() {
              licz_klik++;
              if(licz_klik==1) {
                div.style.backgroundImage= "url('gfx/czolowka2.jpg')"
                document.getElementById("audio").pause();
                document.body.removeChild(document.getElementById("audio"));
              }
              if(licz_klik==2) {
                div.style.backgroundImage= "url('gfx/czolowka3.jpg')"
              }
              if(licz_klik==3) {
                load_game();
              }
            }
        }

        function load_game() {
            document.getElementById("gameDiv").style.backgroundImage= "none";

            var wh = document.createElement("DIV");
            wh.setAttribute("id","whereText");
            wh.setAttribute("class","text");
            wh.innerHTML = "Gdzie jestem";
            document.getElementById("gameDiv").append(wh);


            var p = document.createElement("DIV");
            p.setAttribute("id","picture");
            document.getElementById("gameDiv").append(p);

            var p2 = document.createElement("DIV");
            p2.setAttribute("id","picture2");
            document.getElementById("picture").append(p2);

            var loc = document.createElement("DIV");
            loc.setAttribute("id","locText");
            loc.setAttribute("class","text");
            loc.innerHTML = "You can go";
            document.getElementById("gameDiv").append(loc);

            var see = document.createElement("DIV");
            see.setAttribute("id","seeText");
            see.setAttribute("class","text");
            see.innerHTML = "You see ";
            document.getElementById("gameDiv").append(see);

            var car = document.createElement("DIV");
            car.setAttribute("id","carryText");
            car.setAttribute("class","text");
            car.innerHTML = "Co trzymam";
            document.getElementById("gameDiv").append(car);

            var lab = document.createElement("LABEL");
            lab.setAttribute("id","label");
            lab.innerHTML = "What now?";
            document.getElementById("gameDiv").append(lab);

            var inp = document.createElement("INPUT");
            inp.setAttribute("id","input");
            inp.setAttribute("type","text");
            inp.setAttribute("autofocus", "autofocus");
            inp.onblur = function() { this.focus() };
            inp.onkeypress = function(e) {
                kodAscii= e.which;
                if(e.which == 13){
                    game.ruch();
                }
            }
            inp.oninput = function(e) {
              if(input.value!=0)
              {
                var kod= kodAscii;
                var val = input.value;
                var ost_lit= val[val.length-1];
                //console.log(val)
                val= val.substring(0, val.length-1)
                //console.log(val)
                //console.log(ost_lit, kod)
                if(kod>= 97 && kod<= 122) {
                    input.value= val.toString() + "" + ost_lit.toUpperCase();
                    //console.log("toUp")
                }
                if(kod>= 65 && kod<= 90) {
                    input.value= val.toString() + "" + ost_lit.toLowerCase();
                    //console.log("toLow")
                }
              }
            };
            document.getElementById("label").append(inp);

            var kom = document.createElement("DIV");
            kom.setAttribute("id","kompas");
            document.getElementById("gameDiv").append(kom);

            for(i= 0; i< 4; i++)
            {
              var kw = document.createElement("DIV");
              kw.setAttribute("id","kw"+i);
              kw.setAttribute("class","kw");
              document.getElementById("kompas").append(kw);
            }

            var komunikat = document.createElement("DIV");
            komunikat.setAttribute("id","komunikat");
            document.getElementById("gameDiv").append(komunikat);

            var d_kom = document.createElement("DIV");
            d_kom.setAttribute("id","d_kom1");
            d_kom.setAttribute("class","d_kom");
            document.getElementById("gameDiv").append(d_kom);

            game.start();
        }
		
        var nothing_tab= ["nothing", "nothing" , "1", "nothing"];
        function _Lokacja(str) {
            if(str=="")
              //console.log("nie da sie")
              ;
            else {
              str= str.split(";");
              this.text= str[0];
              this.pic= str[1];
              this.color= str[2];
              this.loc= str[3].split(",");
              if(str.length>4) {
                for(i=0;i<str.length-4;i++)
                {
                  this.item= str[4].split("|");
                  this.item[i]= this.item[i].split(",");
                }
              }
              else
                this.item= [nothing_tab];
              //console.log(this.item)
            }
        }
        var game = {
            x: 3,
            y: 6,
            carry_item: [nothing_tab],
            liczStart: 0,
            dragonIsDead: false,
            location: [
                [
                    new _Lokacja("You are inside a brimstone mine;11.gif;rgb(235,211,64);0,1,0,0"),
                    new _Lokacja("You are at the entrance to the mine;12.gif;rgb(89,93,87);0,1,0,1"),
                    new _Lokacja("A hill;13.gif;rgb(117,237,243);0,1,1,1;31,a STONE,1,STONE"),
                    new _Lokacja("Some bushes;14.gif;rgb(202,230,51);0,1,0,1"),
                    new _Lokacja("An old deserted hut;15.gif;rgb(220,204,61);0,1,0,1;27,a BUCKET,1,BUCKET"),
                    new _Lokacja("The edge of a forest;16.gif;rgb(167,245,63);0,1,0,1"),
                    new _Lokacja("A dark forest;17.gif;rgb(140,253,99);0,0,1,1;14,MUSHROOMS,1,MUSHROOMS")
                ],
                [
                    new _Lokacja("A man nearby making tar;21.gif;rgb(255,190,99);0,1,1,0"),
                    new _Lokacja("A timber yard;22.gif;rgb(255,190,99);0,1,1,1"),
                    new _Lokacja("You are by a roadside shrine;23.gif;rgb(167,245,63);1,1,1,1;10,a KEY,1,KEY"),
                    new _Lokacja("You are by a small chapel;24.gif;rgb(212,229,36);0,1,0,1"),
                    new _Lokacja("You are on a road leading to a wood;25.gif;rgb(167,245,63);0,1,1,1"),
                    new _Lokacja("You are in a forest;26 i 65.gif;rgb(167,245,63);0,1,0,1"),
                    new _Lokacja("You are in a deep forest;27 i 67.gif;rgb(140,253,99);1,0,0,1;18,BERRIES,1,BERRIES")
                ],
                [
                    new _Lokacja("You are by the Vistula River;31.gif;rgb(122,232,252);1,1,0,0"),
                    new _Lokacja("You are by the Vistula River;32.gif;rgb(140,214,255);1,0,0,1;32,a FISH,1,FISH"),
                    new _Lokacja("You are on a bridge over river;33.gif;rgb(108,181,242);1,0,1,0"),
                    new _Lokacja("You are by the old tavern;34.gif;rgb(255,189,117);0,1,0,0"),
                    new _Lokacja("You are at the town's end;35.gif;rgb(255,190,99);1,0,1,1"),
                    new _Lokacja("You are in a butcher's shop;36.gif;rgb(255,188,102);0,0,1,0"),
                    new _Lokacja("You are in a cooper's house;37.gif;rgb(255,188,102);0,0,1,0"),
                ],
                [
                    new _Lokacja("You are in the Wawel Castle;41.gif;rgb(255,176,141);0,1,0,0"),
                    new _Lokacja("You are inside a dragon's cave;42.gif;rgb(198,205,193);0,1,0,1"),
                    new _Lokacja("A perfect place to set a trap;43.gif;rgb(255,176,141);1,0,0,1"),
                    new _Lokacja("You are by the water mill;44.gif;rgb(255,190,99);0,1,0,0;21,a BAG,1,BAG"),
                    new _Lokacja("You are at a main crossroad;45.gif;rgb(255,190,99);1,1,1,1"),
                    new _Lokacja("You are on a town street;46.gif;rgb(255,190,99);1,1,0,1"),
                    new _Lokacja("You are in a frontyard of your house;47.gif;rgb(255,190,99);1,0,1,1")
                ],
                [
                    new _Lokacja(""),
                    new _Lokacja(""),
                    new _Lokacja(""),
                    new _Lokacja("You are by a swift stream;54.gif;rgb(108,181,242);0,1,0,0"),
                    new _Lokacja("You are on a street leading forest;55.gif;rgb(255,190,99);1,0,1,1;33,a KNIFE,1,KNIFE"),
                    new _Lokacja("You are in a woodcutter's backyard;56.gif;rgb(255,190,99);0,0,1,0"),
                    new _Lokacja("You are in a shoemaker's house;57.gif;rgb(254,194,97);1,0,0,0"),
                ],
                [
                    new _Lokacja(""),
                    new _Lokacja(""),
                    new _Lokacja(""),
                    new _Lokacja("You are in a bleak funeral house;64.gif;rgb(254,194,97);0,1,0,0;24,a SPADE,1,SPADE"),
                    new _Lokacja("You are on a path leading to the wood;26 i 65.gif;rgb(167,245,63);1,1,0,1"),
                    new _Lokacja("You are at the edge of a forest;66.gif;rgb(167,245,63);1,1,0,1"),
                    new _Lokacja("You are in a deep forest;27 i 67.gif;rgb(140,253,99);0,0,0,1"),
                ]
            ],
            start: function() {
              game.liczStart++;
              console.log("START");
              var ob_lok= this.location[this.x][this.y];
              document.getElementById("whereText").innerHTML= ob_lok.text;
              var pom="";
              for(i=0;i< ob_lok.item.length ;i++)
              {
                pom+= " "+ob_lok.item[i][1]+","
              }
              pom= pom.substr(0, pom.length-1)
              document.getElementById("seeText").innerHTML= "You see" + pom;
              document.getElementById("carryText").innerHTML= "You are carrying " + game.carry_item[0][1];
              //console.log(ob_lok.pic, this.x, this.y);
              document.getElementById("picture").style.backgroundColor= ob_lok.color;

              if(game.liczStart==1)
                document.getElementById("picture").style.backgroundImage= "url('gfx/"+ob_lok.pic+"')";
              else {
                document.getElementById("picture2").style.backgroundImage= "url('gfx/"+ob_lok.pic+"')";
                document.getElementById("picture2").style.backgroundColor= ob_lok.color;
              }

              /*var lastSc2= 260;
              var sc2= 0;
              var Anim2 = setInterval(frame2, 1);
              function frame2() {
                  if (lastSc2 == sc2) {
                      clearInterval(Anim2);
                      document.getElementById("picture").style.backgroundImage= "none";
                      console.log("animacja 2 zakonczona")
                  }
                  else {
                      lastSc2--;
                      document.getElementById("picture").style.backgroundSize =  "0px "+lastSc2+"px";
                  }
              }
              */
              //////kompas
              for(i= 0; i< 4; i++)
              {
                if(ob_lok.loc[i]=="0")
                {
                  document.getElementById("kw"+i).style.display= "block";
                }
                else
                {
                  document.getElementById("kw"+i).style.display= "none";
                }
              }
              //poprawny tekst pod obrazkiem jak w prawdziwej grze
              var kierunekString= "You can go";
              var zmiana= ob_lok.loc.slice();
              //console.log(ob_lok.loc)
              var pom= zmiana[1];
              zmiana[1]=zmiana[0]
              zmiana[0]=zmiana[3]
              zmiana[3]=zmiana[2]
              zmiana[2]=pom
              //console.log(zmiana, ob_lok.loc)
              for(i= 0; i< 4; i++)
              {
                if(zmiana[i]=="1")
                {
                  var kierunek;
                  switch(i)
                  {
                    case 0:
                      kierunek= "WEST";
                      break;
                    case 1:
                      kierunek= "NORTH";
                      break;
                    case 2:
                      kierunek= "EAST";
                      break;
                    case 3:
                      kierunek= "SOUTH";
                      break;
                  }
                  //console.log(kierunek);
                  kierunekString+= " "+kierunek+","
                }
              }
              /*
              var zmiana= ob_lok.loc;
              for(i= 0; i< 4; i++)
              {
                if(zmiana[i]=="1")
                {
                  var kierunek;
                  switch(i)
                  {
                    case 0:
                      kierunek= "NORTH";
                      break;
                    case 1:
                      kierunek= "EAST";
                      break;
                    case 2:
                      kierunek= "SOUTH";
                      break;
                    case 3:
                      kierunek= "WEST";
                      break;
                  }
                  //console.log(kierunek);
                  kierunekString+= " "+kierunek+","
                }
              }
              */
              kierunekString= kierunekString.substr(0, kierunekString.length-1)
              document.getElementById("locText").innerHTML= kierunekString;
              //console.log(ob_lok);
            },
            readyToKill: 1,
            ruch: function() {
              console.log("RUCH");
              var inp= document.getElementById("input");
              var ob_lok= this.location[this.x][this.y];
              //console.log(ob_lok, this.x, this.y);
              //console.log(ob_lok.text, this.x, this.y);
              //console.log(document.getElementById("input").value)

              /*inp.value+= " "
              var komenda= inp.value.indexOf(" ");
              console.log(komenda);
              komenda= inp.value.substring(0, komenda)
              console.log(komenda);*/
              var komenda_tab= inp.value.split(" ");
              komenda= komenda_tab[0];
              if(komenda_tab.length>0)
                przedmiot= komenda_tab[1];
              console.log(komenda, przedmiot, komenda_tab)
              switch(komenda)
              {
                case "NORTH":
                case "N":
                  console.log("N");
                  if(ob_lok.loc[0]== "1") {
                    this.x--
                    pokaz_kom("north");
                    document.getElementById("picture2").style.height= "0px"
                    var Anim = setInterval(frame, 1);
                  }
                  else
                    pokaz_kom_nie("You can't go that way")
                  break;
                case "EAST":
                case "E":
                  console.log("E");
                  if(ob_lok.loc[1]== "1") {
                    this.y++
                    pokaz_kom("east");
                    document.getElementById("picture2").style.height= "0px"
                    var Anim = setInterval(frame, 1);
                  }
                  else
                    pokaz_kom_nie("You can't go that way")
                  break;
                case "SOUTH":
                case "S":
                  console.log("S");
                  if(ob_lok.loc[2]== "1") {
                    this.x++
                    pokaz_kom("south");
                    document.getElementById("picture2").style.height= "0px"
                    var Anim = setInterval(frame, 1);
                  }
                  else
                    pokaz_kom_nie("You can't go that way")
                  break;
                case "WEST":
                case "W":
                  console.log("W");
                  if(ob_lok.loc[3]== "1") {
                    if(game.dragonIsDead==false && game.x==3 && game.y==1 ) {
                        pokaz_kom_nie("You can't go that way...")
                            setTimeout(function(){
                              pokaz_kom_nie("")
                              setTimeout(function(){
                                pokaz_kom_nie("The dragon sleeps in a cave!")
                              }, 2000);
                            }, 2000);
                    }
                    else {
                        this.y--
                        pokaz_kom("west");
                        document.getElementById("picture2").style.height= "0px"
                        var Anim = setInterval(frame, 1);
                    }
                  }
                  else
                    pokaz_kom_nie("You can't go that way")
                  break;
                  case "TAKE":
                  case "T":
                    console.log("T");
                    console.log(game.carry_item[0][3])
                    if(game.carry_item[0][3]!="nothing")
                      pokaz_kom_nie("You are carrying something")
                    else {
                      var mozna_il= 0;
                      var wlasciwy;
                      for(i=0 ; i< ob_lok.item.length; i++)
                      {
                        if(ob_lok.item[i][3]==przedmiot)
                        {
                          mozna_il++
                          wlasciwy= i
                        }
                      }
                      if(mozna_il!=1)
                        pokaz_kom_nie("There isn't anything like that here")
                      else {
                        if(ob_lok.item[0][2]=="0")
                          pokaz_kom_nie("You can't carry it")
                        else {
                          pokaz_kom_nie("You are taking "+ ob_lok.item[wlasciwy][3])
                          console.log(wlasciwy, ob_lok.item)
                          game.carry_item[0]= ob_lok.item[wlasciwy];
                          console.log(wlasciwy, ob_lok.item)
                          if(ob_lok.item.length==1)
                            ob_lok.item[0]= nothing_tab;
                          else
                            ob_lok.item.splice(wlasciwy, 1)
                          console.log(wlasciwy, ob_lok.item)
                        }
                      }
                    }
                    break;
                  case "DROP":
                  case "D":
                    console.log("D");
                    if(game.carry_item[0][3]=="nothing")
                      pokaz_kom_nie("You are not carrying anything")
                    else {
                      if(game.carry_item[0][3]!=przedmiot)
                        pokaz_kom_nie("You are not carrying it")
                      else {
                        var mozna_il= 0;
                        for(i=0 ; i< ob_lok.item.length; i++)
                        {
                          if(ob_lok.item[i][2]=="1")
                            mozna_il++
                        }
                        console.log("Itemy na lok: "+ mozna_il)
                        if(mozna_il >= 3)
                          pokaz_kom_nie("You can't store any more here")
                        else {
                          pokaz_kom_nie("You are about to drop "+ game.carry_item[0][3])
                          if(ob_lok.item[0][3]=="nothing")
                            ob_lok.item=[];
                          ob_lok.item.push(game.carry_item[0]);
                          game.carry_item[0]= nothing_tab;
                        }
                      }
                    }
                    break;
                  case "USE":
                  case "U":
                    console.log("U");
                    if(game.carry_item[0][3]!=przedmiot)
                      pokaz_kom_nie("You aren't carrying anything like that")
                    else {
                      console.log(game)
                      var lok_x= this.x+1
                      var lok_y= this.y+1
                      var lok_cords= lok_x.toString() + lok_y.toString()
                      console.log(game, lok_cords)

                      switch(game.carry_item[0][0])
                      {
                        case "10":
                          if(lok_cords!="56")
                            pokaz_kom_nie("Nothing happened")
                          else {
                            game.carry_item[0]= ["11", "an AXE", "1", "AXE"]
                            pokaz_kom_nie("You opened a tool shed and took an axe")
                          }
                          break;
                        case "11":
                          if(lok_cords!="67")
                            pokaz_kom_nie("Nothing happened")
                          else {
                            game.carry_item[0]= ["12", "STICKS", "1", "STICKS"]
                            pokaz_kom_nie("You cut sticks for sheeplegs")
                          }
                          break;
                        case "12":
                          if(lok_cords!="43")
                            pokaz_kom_nie("Nothing happened")
                          else {
                            if(ob_lok.item[0][3]=="nothing")
                              ob_lok.item=[];
                            ob_lok.item.push(["13", "sheeplegs", "0", "sheeplegs"]);
                            game.carry_item[0]= nothing_tab;
                            pokaz_kom_nie("You prepared legs for your fake sheep")
                            game.readyToKill++;
                            if(game.readyToKill==6)
                              makeSheep();
                          }
                          break;
                        case "14":
                          if(lok_cords!="34")
                            pokaz_kom_nie("Nothing happened")
                          else {
                            game.carry_item[0]= ["15", "MONEY", "1", "MONEY"]
                            pokaz_kom_nie("The tavern owner paid you money")
                          }
                          break;
                        case "15":
                          if(lok_cords!="37")
                            pokaz_kom_nie("Nothing happened")
                          else {
                            game.carry_item[0]= ["16", "a BARREL", "1", "BARREL"]
                            pokaz_kom_nie("The cooper sold you a new barrel")
                          }
                          break;
                        case "16":
                          if(lok_cords!="43")
                            pokaz_kom_nie("Nothing happened")
                          else {
                            if(ob_lok.item[0][3]=="nothing")
                              ob_lok.item=[];
                            ob_lok.item.push(["17", "sheeptrunk", "0", "sheeptrunk"]);
                            game.carry_item[0]= nothing_tab;
                            pokaz_kom_nie("You made a nice sheeptrunk")
                            game.readyToKill++;
                            if(game.readyToKill==6)
                              makeSheep();
                          }
                          break;
                        case "18":
                          if(lok_cords!="36")
                            pokaz_kom_nie("Nothing happened")
                          else {
                            game.carry_item[0]= ["19", "WOOL", "1", "WOOL"]
                            pokaz_kom_nie("The butcher gave you wool")
                          }
                          break;
                        case "19":
                          if(lok_cords!="43")
                            pokaz_kom_nie("Nothing happened")
                          else {
                            if(ob_lok.item[0][3]=="nothing")
                              ob_lok.item=[];
                            ob_lok.item.push(["20", "a sheepskin" ,"0" ,"sheepskin"]);
                            game.carry_item[0]= nothing_tab;
                            pokaz_kom_nie("You prepared skin for your fake sheep")
                            game.readyToKill++;
                            if(game.readyToKill==6)
                              makeSheep();
                          }
                          break;
                        case "21":
                          if(lok_cords!="57")
                            pokaz_kom_nie("Nothing happened")
                          else {
                            game.carry_item[0]= ["22", "a RAG", "1", "RAG"]
                            pokaz_kom_nie("You used your tools to make a rag")
                          }
                          break;
                        case "22":
                          if(lok_cords!="43")
                            pokaz_kom_nie("Nothing happened")
                          else {
                            if(ob_lok.item[0][3]=="nothing")
                              ob_lok.item=[];
                            ob_lok.item.push(["23", "a sheephead" ,"0" ,"sheephead"]);
                            game.carry_item[0]= nothing_tab;
                            pokaz_kom_nie("You made a fake sheephead")
                            game.readyToKill++;
                            if(game.readyToKill==6)
                              makeSheep();
                          }
                          break;
                        case "24":
                          if(lok_cords!="11")
                            pokaz_kom_nie("Nothing happened")
                          else {
                            pokaz_kom_nie("You are digging...")
                            setTimeout(function(){
                              pokaz_kom_nie("")
                              setTimeout(function(){
                                pokaz_kom_nie("and digging...")
                                setTimeout(function(){
                                  pokaz_kom_nie("")
                                  setTimeout(function(){
                                    pokaz_kom_nie("That's enough sulphur for you")
                                    game.carry_item[0]= ["25", "SULPHUR", "1", "SULPHUR"]
                                    game.start();
                                  }, 2000);
                                }, 2000);
                              }, 2000);
                            }, 2000);

                          }
                          break;
                        case "25":
                          if(lok_cords!="43")
                            pokaz_kom_nie("Nothing happened")
                          else {
                            if(ob_lok.item[0][3]=="nothing")
                              ob_lok.item=[];
                            ob_lok.item.push(["26", "a solid poison" ,"0" ,"solid poison"]);
                            game.carry_item[0]= nothing_tab;
                            pokaz_kom_nie("You prepared a solid poison")
                          }
                          break;
                        case "27":
                          if(lok_cords!="21")
                            pokaz_kom_nie("Nothing happened")
                          else {
                            game.carry_item[0]= ["28", "TAR", "1", "TAR"]
                            pokaz_kom_nie("You got a bucket full of tar")
                          }
                          break;
                        case "28":
                          if(lok_cords!="43")
                            pokaz_kom_nie("Nothing happened")
                          else {
                            if(ob_lok.item[0][3]=="nothing")
                              ob_lok.item=[];
                            ob_lok.item.push(["29", "a liquid poison" ,"0" ,"liquid poison"]);
                            game.carry_item[0]= nothing_tab;
                            pokaz_kom_nie("You prepared a liquid poison")
                            game.readyToKill++;
                            if(game.readyToKill==6)
                              makeSheep();
                          }
                          break;
                        case "37":
                          if(lok_cords!="43")
                            pokaz_kom_nie("Nothing happened")
                          else {
                            pokaz_kom_nie("The dragon noticed your gift...")
                            setTimeout(function(){
                              pokaz_kom_nie("")
                              setTimeout(function(){
                                pokaz_kom_nie("The dragon ate your sheep and died!")
                                if(ob_lok.item[0][3]=="nothing")
                                  ob_lok.item=[];
                                ob_lok.item.push(["30", "a dead dragon", "0", "dead dragon"]);
                                game.carry_item= [nothing_tab];
                                ob_lok.pic= "d_dragon.bmp"
                                game.dragonIsDead= true;
                                //console.log(ob_lok)
                                game.start();
                                console.log(ob_lok)
                              }, 2000);
                            }, 2000);
                          }
                          break;
                        case "33":
                          var lezy_smok= false;
                          for(i=0;i<ob_lok.item.length;i++)
                          {
                            if(ob_lok.item[i][3]=="dead dragon")
                              lezy_smok= true;
                          }
                          if(lok_cords!="43" || lezy_smok==false)
                            pokaz_kom_nie("Nothing happened")
                          else {
                            game.carry_item[0]= ["34", "a DRAGONSKIN", "1", "DRAGONSKIN"]
                            pokaz_kom_nie("You cut a piece of dragon's skin")
                          }
                          break;
                        case "34":
                          if(lok_cords!="57")
                            pokaz_kom_nie("Nothing happened")
                          else {
                            game.carry_item[0]= ["35", "a dragonskin SHOES", "1", "SHOES"]
                            pokaz_kom_nie("You used your tools to make shoes")
                          }
                          break;
                        case "35":
                          if(lok_cords!="41")
                            pokaz_kom_nie("Nothing happened")
                          else {
                            game.carry_item[0]= ["36", "a PRIZE", "1", "PRIZE"]
                            pokaz_kom_nie("The King is impressed by your shoes")
                          }
                          break;
                        case "36":
                          ob_lok.pic="win.gif"
                          ob_lok.color= "rgb(255,0,0)"
                          ob_lok.text= ""
                          game.start();
                          document.getElementById("seeText").style.display= "none";
                          document.getElementById("carryText").style.display= "none";
                          document.getElementById("input").style.display= "none";
                          document.getElementById("locText").style.display= "none";
                          document.getElementById("komunikat").style.display= "block";
                          document.getElementById("komunikat").innerHTML= "Congratulations and thank you for playing!";
                        break;
                        }
                    }
                    break;
                  case "VOCABULARY":
                  case "V":
                    document.getElementById("d_kom1").innerHTML= "NORTH or N, SOUTH or S <br> WEST or W, EAST or E <br>TAKE (object) or T (object) <br>DROP (object) or D (object) <br>USE (object) or U (object) <br>GOSSIPS or G, VOCABULARY or V <br>Press any key";
                    pokaz_d_kom();
                    break;
                  case "GOSSIPS":
                  case "G":
                    document.getElementById("d_kom1").innerHTML= "The  woodcutter lost  his home key...<br>The butcher likes fruit... The cooper<br>is greedy... Dratewka plans to make a<br>poisoned  bait for the dragon...  The<br>tavern owner is buying food  from the<br>pickers... Making a rag from a bag...<br>Press any key"
                    pokaz_d_kom();
                    break;
                  default:
                    pokaz_kom_nie("Try another word or V for vocabulary")
              }
              game.start();

              function pokaz_d_kom () {
                document.getElementById("d_kom1").style.display= "block";
                document.getElementById("input").style.display= "none";
                var licz_klik= 0;
                document.body.onkeyup= function() {
                  licz_klik++;
                  if(licz_klik==2) {
                    document.getElementById("d_kom1").style.display= "none";
                    document.getElementById("input").style.display= "inline-block";
                    document.getElementById("input").focus();
                  }
                }
              }
              function makeSheep() {
                setTimeout(function () {
                    petla();
                    function petla () {
                      for(i=0;i< ob_lok.item.length;i++)
                      {
                        if(ob_lok.item[i][2]=="0") {
                          ob_lok.item.splice(i, 1)
                          petla();
                        }
                      }
                    }
                  if(ob_lok.item.length==0)
                    ob_lok.item.push(nothing_tab)
                  game.carry_item[0]= ["37", "a SHEEP" ,"1" ,"SHEEP"];
                  game.start();
                  pokaz_kom_nie("Your fake sheep is full of poison and ready to be eaten by the dragon")
                }, 2000);
              }
              ////////komunikaty
              function pokaz_kom(gdzie) {
                document.getElementById("input").style.display= "none";
                document.getElementById("komunikat").style.display= "block";
                document.getElementById("komunikat").innerHTML= "You are going "+gdzie+"..."
              }
              function pokaz_kom_nie(zmienna) {
                document.getElementById("input").style.display= "none";
                document.getElementById("komunikat").style.display= "block";
                document.getElementById("komunikat").innerHTML= zmienna;
                setTimeout(function(){
                  document.getElementById("komunikat").style.display= "none"
                  document.getElementById("input").style.display= "inline-block";
                  document.getElementById("input").focus();
                ;}, 2000);
              }
              //////animacja obrazka
              var ob_lok= this.location[this.x][this.y];
              //var lastSc= -160;
              var lastSc= 0;
              var sc= 160;
              function frame() {
                  if (lastSc == sc) {
                      clearInterval(Anim);
                      document.getElementById("picture").style.backgroundImage= "url('gfx/"+ob_lok.pic+"')";
                      //console.log(ob_lok)
                      document.getElementById("picture2").style.backgroundImage= "none";
                      document.getElementById("picture2").style.backgroundColor= "transparent";
                      document.getElementById("komunikat").style.display= "none";
                      document.getElementById("input").style.display= "inline-block";
                      document.getElementById("input").focus();
                      console.log("animacja zakonczona")
                  }
                  else {
                      lastSc++;
                      //document.getElementById("picture2").style.backgroundPosition =  "0px "+lastSc+"px";
                      document.getElementById("picture2").style.height= lastSc+"px"
                  }
              }
              //console.log(ob_lok.text, this.x, this.y);
              inp.value = '';
            },
        }
    </script>
</head>
<body>
</body>
</html>
